{"ast":null,"code":"import _objectSpread from\"C:/Users/user/Desktop/HOLIDAYQR/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from\"react\";import axios from\"axios\";import{useNavigate}from\"react-router-dom\";import{toast}from\"react-toastify\";import\"react-toastify/dist/ReactToastify.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ReelUpload=_ref=>{let{itineraryId=null}=_ref;const navigate=useNavigate();const[itineraries,setItineraries]=useState([]);const[formData,setFormData]=useState({itinerary:itineraryId||\"\",video:null});const[reels,setReels]=useState([]);const apiBase=process.env.REACT_APP_API_BASE;useEffect(()=>{const token=localStorage.getItem(\"auth_token\");if(!token){toast.error(\"‚ùå Please login to upload reels.\");navigate(\"/login\");return;}if(!itineraryId){axios.get(\"\".concat(apiBase,\"itineraries/\")).then(res=>setItineraries(res.data)).catch(err=>console.error(\"Error fetching itineraries:\",err));}axios.get(\"\".concat(apiBase,\"reels/\").concat(itineraryId?\"?itinerary=\".concat(itineraryId):\"\")).then(res=>setReels(res.data)).catch(err=>console.error(\"Error fetching reels:\",err));},[navigate,apiBase,itineraryId]);const handleChange=e=>{if(e.target.name===\"video\"){setFormData(_objectSpread(_objectSpread({},formData),{},{video:e.target.files[0]}));}else{setFormData(_objectSpread(_objectSpread({},formData),{},{[e.target.name]:e.target.value}));}};const handleSubmit=e=>{e.preventDefault();const data=new FormData();data.append(\"itinerary\",formData.itinerary);data.append(\"video\",formData.video);axios.post(\"\".concat(apiBase,\"reels/\"),data,{headers:{\"Content-Type\":\"multipart/form-data\"}}).then(()=>{toast.success(\"üéâ Reel uploaded successfully!\");setFormData({itinerary:itineraryId||\"\",video:null});document.getElementById(\"reel-upload-form\").reset();axios.get(\"\".concat(apiBase,\"reels/\").concat(itineraryId?\"?itinerary=\".concat(itineraryId):\"\")).then(res=>setReels(res.data));}).catch(error=>{console.error(\"Upload error:\",error);toast.error(\"‚ùå Upload failed. Please try again.\");});};return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-xl mx-auto bg-white dark:bg-gray-800 p-6 rounded shadow-md\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-semibold mb-4\",children:\"Upload Reel\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-4\",id:\"reel-upload-form\",children:[!itineraryId&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"itinerary\",className:\"block font-medium mb-1\",children:\"Select Itinerary\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"itinerary\",value:formData.itinerary,onChange:handleChange,className:\"w-full border px-3 py-2 rounded\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Choose --\"}),itineraries.map(item=>/*#__PURE__*/_jsxs(\"option\",{value:item.id,children:[item.title,\" (\",item.destination,\")\"]},item.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"video\",className:\"block font-medium mb-1\",children:\"Upload Video\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"video\",accept:\"video/*\",onChange:handleChange,className:\"w-full\",required:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700\",children:\"Upload\"})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"my-6\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold mb-2\",children:\"Recently Uploaded Reels\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 gap-4\",children:reels.map(reel=>/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"video\",{controls:true,width:\"100%\",src:\"\".concat(apiBase.replace(\"/api/\",\"\")).concat(reel.video)})},reel.id))})]});};export default ReelUpload;","map":{"version":3,"names":["React","useEffect","useState","axios","useNavigate","toast","jsx","_jsx","jsxs","_jsxs","ReelUpload","_ref","itineraryId","navigate","itineraries","setItineraries","formData","setFormData","itinerary","video","reels","setReels","apiBase","process","env","REACT_APP_API_BASE","token","localStorage","getItem","error","get","concat","then","res","data","catch","err","console","handleChange","e","target","name","_objectSpread","files","value","handleSubmit","preventDefault","FormData","append","post","headers","success","document","getElementById","reset","className","children","onSubmit","id","htmlFor","onChange","required","map","item","title","destination","type","accept","reel","controls","width","src","replace"],"sources":["C:/Users/user/Desktop/HOLIDAYQR/frontend/src/components/ReelUpload.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\n\r\nconst ReelUpload = ({ itineraryId = null }) => {\r\n  const navigate = useNavigate();\r\n  const [itineraries, setItineraries] = useState([]);\r\n  const [formData, setFormData] = useState({ itinerary: itineraryId || \"\", video: null });\r\n  const [reels, setReels] = useState([]);\r\n  const apiBase = process.env.REACT_APP_API_BASE;\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"auth_token\");\r\n    if (!token) {\r\n      toast.error(\"‚ùå Please login to upload reels.\");\r\n      navigate(\"/login\");\r\n      return;\r\n    }\r\n\r\n    if (!itineraryId) {\r\n      axios\r\n        .get(`${apiBase}itineraries/`)\r\n        .then((res) => setItineraries(res.data))\r\n        .catch((err) => console.error(\"Error fetching itineraries:\", err));\r\n    }\r\n\r\n    axios\r\n      .get(`${apiBase}reels/${itineraryId ? `?itinerary=${itineraryId}` : \"\"}`)\r\n      .then((res) => setReels(res.data))\r\n      .catch((err) => console.error(\"Error fetching reels:\", err));\r\n  }, [navigate, apiBase, itineraryId]);\r\n\r\n  const handleChange = (e) => {\r\n    if (e.target.name === \"video\") {\r\n      setFormData({ ...formData, video: e.target.files[0] });\r\n    } else {\r\n      setFormData({ ...formData, [e.target.name]: e.target.value });\r\n    }\r\n  };\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    const data = new FormData();\r\n    data.append(\"itinerary\", formData.itinerary);\r\n    data.append(\"video\", formData.video);\r\n\r\n    axios\r\n      .post(`${apiBase}reels/`, data, {\r\n        headers: { \"Content-Type\": \"multipart/form-data\" },\r\n      })\r\n      .then(() => {\r\n        toast.success(\"üéâ Reel uploaded successfully!\");\r\n        setFormData({ itinerary: itineraryId || \"\", video: null });\r\n        document.getElementById(\"reel-upload-form\").reset();\r\n\r\n        axios\r\n          .get(`${apiBase}reels/${itineraryId ? `?itinerary=${itineraryId}` : \"\"}`)\r\n          .then((res) => setReels(res.data));\r\n      })\r\n      .catch((error) => {\r\n        console.error(\"Upload error:\", error);\r\n        toast.error(\"‚ùå Upload failed. Please try again.\");\r\n      });\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-xl mx-auto bg-white dark:bg-gray-800 p-6 rounded shadow-md\">\r\n      <h2 className=\"text-2xl font-semibold mb-4\">Upload Reel</h2>\r\n      <form onSubmit={handleSubmit} className=\"space-y-4\" id=\"reel-upload-form\">\r\n        {!itineraryId && (\r\n          <div>\r\n            <label htmlFor=\"itinerary\" className=\"block font-medium mb-1\">\r\n              Select Itinerary\r\n            </label>\r\n            <select\r\n              name=\"itinerary\"\r\n              value={formData.itinerary}\r\n              onChange={handleChange}\r\n              className=\"w-full border px-3 py-2 rounded\"\r\n              required\r\n            >\r\n              <option value=\"\">-- Choose --</option>\r\n              {itineraries.map((item) => (\r\n                <option key={item.id} value={item.id}>\r\n                  {item.title} ({item.destination})\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n        )}\r\n        <div>\r\n          <label htmlFor=\"video\" className=\"block font-medium mb-1\">\r\n            Upload Video\r\n          </label>\r\n          <input\r\n            type=\"file\"\r\n            name=\"video\"\r\n            accept=\"video/*\"\r\n            onChange={handleChange}\r\n            className=\"w-full\"\r\n            required\r\n          />\r\n        </div>\r\n        <button\r\n          type=\"submit\"\r\n          className=\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700\"\r\n        >\r\n          Upload\r\n        </button>\r\n      </form>\r\n\r\n      <hr className=\"my-6\" />\r\n      <h3 className=\"text-xl font-semibold mb-2\">Recently Uploaded Reels</h3>\r\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n        {reels.map((reel) => (\r\n          <div key={reel.id}>\r\n            <video\r\n              controls\r\n              width=\"100%\"\r\n              src={`${apiBase.replace(\"/api/\", \"\")}${reel.video}`}\r\n            />\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ReelUpload;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}